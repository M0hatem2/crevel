<!-- Modal Backdrop with Blur Effect -->
<div *ngIf="isOpen" class="fixed inset-0 z-50 overflow-y-auto modal-open" (click)="closeModal()"
  style="backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); background: rgba(0,0,0,0.6);">

  <!-- Modal Container -->
  <div class="flex items-center justify-center min-h-screen p-2 sm:p-4">
    <div
      class="relative bg-[#081110] border border-[#1e2f2d] rounded-xl shadow-2xl max-w-4xl w-full h-[95vh] sm:h-[90vh] flex flex-col mx-auto"
      (click)="$event.stopPropagation()">

      <!-- Modal Header -->
      <div class="flex justify-between items-center p-3 sm:p-6 border-b border-[#1e2f2d] flex-shrink-0">
        <div class="min-w-0 flex-1">
          <h3 class="text-lg sm:text-xl font-bold text-white truncate">{{ selectedItem?.title_en }}</h3>
          <p class="text-gray-400 text-xs sm:text-sm truncate">{{ selectedItem?.title_ar }}</p>
        </div>
        <button type="button"
          class="text-gray-400 hover:text-white transition-colors p-1 sm:p-2 rounded-lg hover:bg-[#1e2f2d] flex-shrink-0 ml-2"
          (click)="closeModal()">
          <i class="fas fa-times text-lg sm:text-xl"></i>
        </button>
      </div>

      <!-- Modal Body -->
      <div class="flex-1 p-3 sm:p-6 overflow-y-auto min-h-0">

        <!-- Project Details Grid -->
        <div class="grid md:grid-cols-2 gap-6 mb-6">

          <!-- Left Column - Basic Info -->
          <div class="space-y-4">
            <div>
              <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
                <i class="fas fa-info-circle text-[#eec044]"></i>
                Project Information
              </h4>

              <!-- Category -->
              <div class="mb-3">
                <span class="text-gray-400 text-sm">Category:</span>
                <span class="text-white ml-2 px-3 py-1 bg-[#1e2f2d] rounded-full text-sm">{{ selectedItem?.category
                  }}</span>
              </div>

              <!-- Created Date -->
              <div class="mb-3">
                <span class="text-gray-400 text-sm">Created:</span>
                <span class="text-gray-300 ml-2">{{ selectedItem?.createdAt | date:'medium' }}</span>
              </div>

              <!-- Added By -->
              <div class="mb-3">
                <span class="text-gray-400 text-sm">Added by:</span>
                <span class="text-gray-300 ml-2">{{ selectedItem?.addedBy?.fullName }}</span>
              </div>

              <!-- Links -->
              <div class="space-y-2">
                <div *ngIf="selectedItem?.githubRepo" class="flex items-center gap-2">
                  <i class="fab fa-github text-gray-400"></i>
                  <a [href]="selectedItem?.githubRepo" target="_blank"
                    class="text-blue-400 hover:text-blue-300 transition-colors">
                    View on GitHub
                  </a>
                </div>
                <div *ngIf="selectedItem?.productionUrl" class="flex items-center gap-2">
                  <i class="fas fa-external-link-alt text-gray-400"></i>
                  <a [href]="selectedItem?.productionUrl" target="_blank"
                    class="text-blue-400 hover:text-blue-300 transition-colors">
                    View Live Demo
                  </a>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column - Images -->
          <div class="space-y-4">
            <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
              <i class="fas fa-images text-[#eec044]"></i>
              Project Images
            </h4>

            <!-- Main Image -->
            <div class="mb-4">
              <p class="text-gray-400 text-sm mb-2">Main Project Image:</p>
              <div class="relative group">
                <img [src]="selectedItem?.image?.secure_url" alt="Main Project Image"
                  class="w-full h-48 object-cover rounded-lg border border-[#1e2f2d] transition-transform group-hover:scale-105">
                <div class="absolute inset-0  bg-opacity-1 group-hover:bg-opacity-20 transition-all rounded-lg"></div>
              </div>
            </div>

            <!-- Gallery Images -->
            <div *ngIf="hasGalleryImages()">
              <p class="text-gray-400 text-sm mb-2">Gallery ({{ selectedItem?.gallery?.length }} images):</p>
              <div class="grid grid-cols-3 gap-2">
                <div *ngFor="let galleryImg of selectedItem?.gallery; let i = index"
                  class="relative group cursor-pointer" (click)="openImageModal(galleryImg.secure_url)">
                  <img [src]="galleryImg.secure_url" [alt]="'Gallery Image ' + (i + 1)"
                    class="w-full h-20 object-cover rounded border border-[#1e2f2d] transition-all group-hover:border-[#eec044] group-hover:scale-105">
                  <div
                    class="absolute inset-0   bg-opacity-50 group-hover:bg-opacity-30 transition-all rounded flex items-center justify-center">
                    <i class="fas fa-search  text-green-500 opacity-0 group-hover:opacity-100 transition-opacity "></i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Description Section -->
        <div class="mt-6">
          <h4 class="text-lg font-semibold text-white mb-3 flex items-center gap-2">
            <i class="fas fa-align-left text-[#eec044]"></i>
            Project Description
          </h4>

          <!-- English Description -->
          <div class="mb-4">
            <h5 class="text-gray-300 font-medium mb-2">English:</h5>
            <div class="bg-[#0f1a19] border border-[#1e2f2d] rounded-lg p-4">
              <p class="text-gray-300 leading-relaxed">{{ selectedItem?.description_en }}</p>
            </div>
          </div>

          <!-- Arabic Description -->
          <div class="mb-4">
            <h5 class="text-gray-300 font-medium mb-2">العربية:</h5>
            <div class="bg-[#0f1a19] border border-[#1e2f2d] rounded-lg p-4 arabic-font">
              <p class="text-gray-300 leading-relaxed">{{ selectedItem?.description_ar }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal Footer -->
      <div
        class="flex flex-col sm:flex-row sm:justify-between sm:items-center p-3 sm:p-6 border-t border-[#1e2f2d] bg-[#0a1312] gap-3 flex-shrink-0">
        <div class="text-xs sm:text-sm text-gray-400 order-2 sm:order-1">
          Project ID: {{ selectedItem?._id }}
        </div>


      </div>
    </div>
  </div>
</div>

<!-- Image Modal (for viewing gallery images) -->
<div *ngIf="showImageModal" class="fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-90 p-2"
  (click)="closeImageModal()">
  <div class="relative max-w-sm sm:max-w-2xl md:max-w-4xl max-h-[90vh] w-full" (click)="$event.stopPropagation()">
    <img [src]="selectedImageUrl" alt="Gallery Image" class="max-w-full max-h-full object-contain rounded-lg mx-auto">
    <button type="button"
      class="absolute top-1 right-1 sm:top-2 sm:right-2 text-white hover:text-gray-300 bg-black bg-opacity-50 rounded-full p-1 sm:p-2 transition-colors"
      (click)="closeImageModal()">
      <i class="fas fa-times text-sm sm:text-base"></i>
    </button>
  </div>
</div>