<section class="core-services-section py-20 bg-white/5 text-white arabic-font">
  <div class="container mx-auto px-6">

    <!-- Header -->
    <div class="text-center mb-16 fade-in">
      <h2 class="text-4xl md:text-5xl font-bold mb-4">{{ 'SERVICES.CORE_SERVICES.TITLE' | translate }}</h2>
      <p class="text-white/70 text-lg max-w-2xl mx-auto leading-relaxed">
        {{ 'SERVICES.CORE_SERVICES.SUBTITLE' | translate }}
      </p>
    </div>

    <!-- Services grid -->
    <div *ngIf="!loading && services?.length" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
      <div *ngFor="let service of services; trackBy: trackByServiceId"
        class="relative my-6 bg-gradient-to-br from-[#1b2a2a] to-[#0d1b1b] border border-[#52A3A7] rounded-2xl p-8 pt-16 text-center shadow-xl hover:scale-[1.05] transition-transform duration-300 ease-in-out group cursor-pointer"
        (click)="onServiceClick(service)">

        <!-- Icon -->
        <div
          class="absolute -top-11 {{currentLanguage === 'ar' ? 'right-1/2 translate-x-1/20 ' : 'left-1/2'}} transform -translate-x-1/2 bg-[#52A3A7] text-white p-6 w-22 h-22 rounded-full shadow-[0_0_35px_#52A3A7] group-hover:rotate-6 transition duration-300 text-3xl">
          <i class="fa-solid {{service.icon || 'fa-solid fa-gear' }} font-2xl"></i>
        </div>

        <!-- Title -->
        <h3 class="text-2xl font-bold uppercase mb-4 text-[#57c4c1] tracking-wide">
          {{ currentLanguage === 'ar' ? (service.title_ar || service.title_en) : service.title_en }}
        </h3>

        <!-- Description -->
        <p class="text-gray-300 text-sm leading-relaxed tracking-wide line-clamp-4 overflow-hidden">
          {{ currentLanguage === 'ar' ? (service.description_ar || service.description_en) : service.description_en }}
        </p>
      </div>
    </div>
  </div>

  <!-- Service Details Modal -->
  <div *ngIf="showModal" class="core-services-modal-overlay" (click)="closeModal()">
    <div class="core-services-modal modal-content" (click)="$event.stopPropagation()">

      <!-- Close Button -->
      <button (click)="closeModal()" class="modal-close-btn">
        <i class="fas fa-times"></i>
      </button>

      <!-- Loading State -->
      <div *ngIf="modalLoading" class="modal-loading">
      <app-loading-spinner></app-loading-spinner>
      </div>

      <!-- Error State -->
      <div *ngIf="error && !modalLoading" class="modal-error">
        <i class="fas fa-exclamation-triangle"></i>
        <p>{{ error }}</p>
        <button (click)="closeModal()" class="btn-primary">
          {{ 'COMMON.CLOSE' | translate }}
        </button>
      </div>

      <!-- Service Details -->
      <div *ngIf="selectedServiceData && !modalLoading && !error" class="space-y-6">

        <!-- Header -->
        <div class="modal-header">
          <div class="service-icon">
            <i [class]="'fas ' + getServiceIcon(selectedServiceData.icon)"></i>
          </div>
          <h2>{{ currentLanguage === 'ar' ? (selectedServiceData.title_ar || selectedServiceData.title_en) :
            selectedServiceData.title_en }}</h2>
        </div>

        <!-- Description -->
        <div class="modal-description">
          <h3>{{ 'SERVICES.CORE_SERVICES.DESCRIPTION' | translate }}</h3>
          <p>{{ currentLanguage === 'ar' ? (selectedServiceData.description_ar || selectedServiceData.description_en) :
            selectedServiceData.description_en }}</p>
        </div>

        <!-- Service Info Grid -->
        <div class="modal-info-grid">


          <div class="info-item">
            <i class="fas fa-calendar"></i>
            <span class="label">{{ 'SERVICES.CORE_SERVICES.LAST_UPDATED' | translate }}</span>
            <span class="value">{{ 'SERVICES.CORE_SERVICES.RECENTLY' | translate }}</span>
          </div>
          <div class="info-item">
            <i class="fas fa-check-circle"></i>
            <span class="label">{{ 'SERVICES.CORE_SERVICES.STATUS' | translate }}</span>
            <span class="value" style="color: #10b981;">{{ 'SERVICES.CORE_SERVICES.ACTIVE' | translate }}</span>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="modal-actions">
          <button (click)="closeModal()" class="btn-secondary">
            <i class="fas fa-times"></i>
            {{ 'SERVICES.CORE_SERVICES.CLOSE' | translate }}
          </button>

        </div>
      </div>
    </div>
  </div>
</section>