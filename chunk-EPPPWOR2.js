import{a as $}from"./chunk-DQIHD3SX.js";import{b as L,d as R,e as G,f as J,g as K,h as Q,p as X,s as Y}from"./chunk-UMXV7FSD.js";import{a as q,c as z,f as Z}from"./chunk-E3PR7NZM.js";import{i as j,j as D,k as N,m as W,n as P,o as B}from"./chunk-KT27TMF4.js";import{$ as u,Ab as l,Bb as f,Cb as I,Da as s,Eb as x,Fb as h,Gb as A,Ja as O,M as U,Mb as C,Ob as H,Pa as k,Pb as T,Q as V,U as F,Ua as _,aa as p,db as g,eb as n,fb as r,gb as m,mb as w,o as v,qb as b,r as y,sb as c,z as S,za as M}from"./chunk-IGH6FCT7.js";var E=class a{constructor(e){this.http=e}apiUrl=`${Z.apiUrl}/admin/aboutUs`;getAboutUs(){return console.log("AdminAboutUsService: Making request to:",this.apiUrl),console.log("AdminAboutUsService: With headers:",this.getAuthHeaders()),this.http.get(this.apiUrl,{headers:this.getHeaders()}).pipe(U(e=>{console.log("AdminAboutUsService: Response received:",e)}),y(e=>e.data||e),S(e=>(console.error("AdminAboutUsService: Error occurred:",e),v(()=>e))))}editAboutUs(e,t){return console.log("AdminAboutUsService: Saving about us:",e||"new",t),this.http.patch(this.apiUrl,t,{headers:this.getHeaders(t)}).pipe(U(i=>{console.log("AdminAboutUsService: Save about us response:",i)}),y(i=>i.data||i),S(i=>(console.error("AdminAboutUsService: Save about us error:",i),v(()=>i))))}patchAboutUs(e,t){return console.log("AdminAboutUsService: PATCH editing about us:",e,t),this.http.patch(`${this.apiUrl}/${e}`,t,{headers:this.getHeaders(t)}).pipe(U(i=>{console.log("AdminAboutUsService: PATCH edit about us response:",i)}),y(i=>i.data||i),S(i=>(console.error("AdminAboutUsService: PATCH edit about us error:",i),v(()=>i))))}getHeaders(e){let t=new q(this.getAuthHeaders());return e instanceof FormData||(t=t.set("Content-Type","application/json")),t}getAuthHeaders(){let e=localStorage.getItem("token");return e?{Authorization:`Access ${e}`}:{}}static \u0275fac=function(t){return new(t||a)(F(z))};static \u0275prov=V({token:a,factory:a.\u0275fac,providedIn:"root"})};function ne(a,e){a&1&&(n(0,"div",9),m(1,"app-loading-spinner"),r())}function re(a,e){if(a&1){let t=w();n(0,"div",10),m(1,"i",11),n(2,"p",12),l(3),r(),n(4,"button",13),b("click",function(){u(t);let o=c();return p(o.loadAboutUs())}),m(5,"i",14),l(6," Retry "),r()()}if(a&2){let t=c();s(3),f(t.error)}}function oe(a,e){if(a&1&&m(0,"img",32),a&2){let t=e.$implicit;g("src",t.secure_url,M)}}function ae(a,e){if(a&1&&m(0,"img",33),a&2){let t=e.$implicit;g("src",t.secure_url,M)}}function le(a,e){if(a&1){let t=w();n(0,"tr",22)(1,"td",23),l(2),r(),n(3,"td",24),l(4),r(),n(5,"td",24),l(6),C(7,"slice"),r(),n(8,"td",24),l(9),C(10,"slice"),r(),n(11,"td",24)(12,"div",25),_(13,oe,1,1,"img",26),r()(),n(14,"td",24)(15,"div",25),_(16,ae,1,1,"img",27),r()(),n(17,"td",28),l(18),C(19,"date"),r(),n(20,"td",29)(21,"button",30),b("click",function(){let o=u(t).$implicit,d=c(2);return p(d.editAboutUs(o))}),m(22,"i",31),r()()()}if(a&2){let t=e.$implicit;s(2),f(t.title_en),s(2),f(t.title_ar),s(2),I("",T(7,7,t.description_en,0,50),"..."),s(3),I("",T(10,11,t.description_ar,0,50),"..."),s(4),g("ngForOf",t.scrollingImages),s(3),g("ngForOf",t.aboutUsImages),s(2),f(H(19,15,t.createdAt,"mediumDate"))}}function se(a,e){if(a&1&&(n(0,"div",15)(1,"table",16)(2,"thead")(3,"tr",17)(4,"th",18),l(5,"Title EN"),r(),n(6,"th",18),l(7,"Title AR"),r(),n(8,"th",18),l(9,"Description EN"),r(),n(10,"th",18),l(11,"Description AR"),r(),n(12,"th",18),l(13,"Scrolling Images"),r(),n(14,"th",18),l(15,"About Us Images"),r(),n(16,"th",18),l(17,"Created At"),r(),n(18,"th",19),l(19,"Actions"),r()()(),n(20,"tbody",20),_(21,le,23,18,"tr",21),r()()()),a&2){let t=c();s(21),g("ngForOf",t.aboutUs)}}function de(a,e){if(a&1){let t=w();n(0,"div",34)(1,"div",35)(2,"h3",36),m(3,"i",37),l(4),r(),n(5,"form",38),b("ngSubmit",function(){u(t);let o=c();return p(o.saveAboutUs())}),n(6,"input",39),A("ngModelChange",function(o){u(t);let d=c();return h(d.form.title_en,o)||(d.form.title_en=o),p(o)}),r(),n(7,"textarea",40),A("ngModelChange",function(o){u(t);let d=c();return h(d.form.description_en,o)||(d.form.description_en=o),p(o)}),r(),n(8,"input",41),A("ngModelChange",function(o){u(t);let d=c();return h(d.form.title_ar,o)||(d.form.title_ar=o),p(o)}),r(),n(9,"textarea",42),A("ngModelChange",function(o){u(t);let d=c();return h(d.form.description_ar,o)||(d.form.description_ar=o),p(o)}),r(),n(10,"div")(11,"label",43),m(12,"i",44),l(13," Scrolling Images"),r(),n(14,"input",45),b("change",function(o){u(t);let d=c();return p(d.onScrollingImagesChange(o))}),r()(),n(15,"div")(16,"label",43),m(17,"i",46),l(18," About Us Images"),r(),n(19,"input",45),b("change",function(o){u(t);let d=c();return p(d.onAboutUsImagesChange(o))}),r()(),n(20,"div",47)(21,"button",48),b("click",function(){u(t);let o=c();return p(o.closeModal())}),m(22,"i",49),l(23," Cancel "),r(),n(24,"button",50),m(25,"i",51),l(26," Save "),r()()()()()}if(a&2){let t=c();s(3),g("ngClass",t.editMode?"fa-edit":"fa-plus-circle"),s(),I(" ",t.editMode?"Edit":"Add"," About Us "),s(2),x("ngModel",t.form.title_en),s(),x("ngModel",t.form.description_en),s(),x("ngModel",t.form.title_ar),s(),x("ngModel",t.form.description_ar)}}var ee=class a{constructor(e){this.adminAboutUsService=e}aboutUs=[];loading=!1;error=null;ngOnInit(){this.loadAboutUs()}loadAboutUs(){this.loading=!0,this.error=null,console.log("AdminAboutUS: Starting to load about us..."),this.adminAboutUsService.getAboutUs().subscribe({next:e=>{console.log("AdminAboutUS: Success response:",e);let t;Array.isArray(e)?t=e[0]?.aboutUs||e[0]?.data||e[0]:t=e.aboutUs||e.data||e,this.aboutUs=Array.isArray(t)?t:[t],this.loading=!1,console.log("AdminAboutUS: About us loaded:",this.aboutUs)},error:e=>{console.error("AdminAboutUS: Error details:",e),this.error=e.message||"Failed to load about us",this.loading=!1,console.log("AdminAboutUS: Error message:",this.error)}})}isModalOpen=!1;editMode=!1;form={title_en:"",title_ar:"",description_en:"",description_ar:"",scrollingImages:[],aboutUsImages:[]};editingId=null;selectedScrollingImages=[];selectedAboutUsImages=[];openAddAboutUsModal(){this.editMode=!1,this.form={title_en:"",title_ar:"",description_en:"",description_ar:"",scrollingImages:[],aboutUsImages:[]},this.isModalOpen=!0}saveAboutUs(){let e=new FormData;e.append("title_en",this.form.title_en),e.append("title_ar",this.form.title_ar),e.append("description_en",this.form.description_en),e.append("description_ar",this.form.description_ar),this.selectedScrollingImages.forEach(t=>{e.append("scrollingImages",t)}),this.selectedAboutUsImages.forEach(t=>{e.append("aboutUsImages",t)}),this.editMode&&this.editingId?this.updateAboutUs(e):this.updateAboutUs(e)}editAboutUs(e){this.editMode=!0,this.editingId=e._id||e.id,this.form={title_en:e.title_en||"",title_ar:e.title_ar||"",description_en:e.description_en||"",description_ar:e.description_ar||"",scrollingImages:e.scrollingImages||[],aboutUsImages:e.aboutUsImages||[]},this.selectedScrollingImages=[],this.selectedAboutUsImages=[],this.isModalOpen=!0}updateAboutUs(e){this.loading=!0,this.error=null,(this.editingId?this.adminAboutUsService.editAboutUs(this.editingId,e):this.adminAboutUsService.editAboutUs("",e)).subscribe({next:i=>{console.log("AdminAboutUS: About us saved successfully:",i),this.isModalOpen=!1,this.loadAboutUs()},error:i=>{console.error("AdminAboutUS: Error saving about us:",i),this.error=i.message||"Failed to save about us",this.loading=!1}})}closeModal(){this.isModalOpen=!1}onScrollingImagesChange(e){this.selectedScrollingImages=Array.from(e.target.files)}onAboutUsImagesChange(e){this.selectedAboutUsImages=Array.from(e.target.files)}static \u0275fac=function(t){return new(t||a)(O(E))};static \u0275cmp=k({type:a,selectors:[["app-admin-about-us"]],decls:10,vars:4,consts:[[1,"p-6","bg-[#041f1e]","text-white","min-h-screen","arabic-font"],[1,"max-w-6xl","mx-auto","bg-[#1e4d4e]","rounded-2xl","shadow-2xl","p-8","border","border-[var(--icon-color)]"],[1,"flex","justify-between","items-center","mb-8","border-b","border-gray-700","pb-4"],[1,"text-3xl","font-bold","flex","items-center","gap-2"],[1,"fas","fa-users-cog","text-[var(--icon-color)]"],["class","text-center py-10 text-gray-400 text-lg",4,"ngIf"],["class","text-center py-10 text-red-400",4,"ngIf"],["class","overflow-x-auto rounded-lg shadow-inner",4,"ngIf"],["class","fixed inset-0 bg-black/60 flex items-center justify-center z-50 ",4,"ngIf"],[1,"text-center","py-10","text-gray-400","text-lg"],[1,"text-center","py-10","text-red-400"],[1,"fas","fa-exclamation-triangle","text-2xl","mb-3"],[1,"text-lg","mb-4"],[1,"bg-[var(--icon-color)]","hover:bg-[#449397]","px-5","py-2","rounded-lg","font-medium","text-white","transition-all",3,"click"],[1,"fas","fa-redo"],[1,"overflow-x-auto","rounded-lg","shadow-inner"],[1,"min-w-full","text-sm","border","border-gray-700"],[1,"bg-[#154142]","text-gray-200"],[1,"py-3","px-4","text-left"],[1,"py-3","px-4","text-center"],[1,"divide-y","divide-gray-700"],["class","hover:bg-[#173b3c] transition-all",4,"ngFor","ngForOf"],[1,"hover:bg-[#173b3c]","transition-all"],[1,"py-3","px-4","font-semibold"],[1,"py-3","px-4"],[1,"flex","space-x-1"],["alt","Scrolling Image","class","w-8 h-8 object-cover rounded border border-gray-600",3,"src",4,"ngFor","ngForOf"],["alt","About Us Image","class","w-8 h-8 object-cover rounded border border-gray-600",3,"src",4,"ngFor","ngForOf"],[1,"py-3","px-4","text-gray-400","text-xs"],[1,"py-3","px-4","text-center","space-x-3"],["title","Edit About Us",1,"text-blue-400","hover:text-blue-300","transition-all",3,"click"],[1,"fas","fa-edit","text-lg"],["alt","Scrolling Image",1,"w-8","h-8","object-cover","rounded","border","border-gray-600",3,"src"],["alt","About Us Image",1,"w-8","h-8","object-cover","rounded","border","border-gray-600",3,"src"],[1,"fixed","inset-0","bg-black/60","flex","items-center","justify-center","z-50"],[1,"bg-[#1e4d4e]","max-w-2xl","p-6","rounded-2xl","shadow-2xl","max-w-lg","border","border-[var(--icon-color)]","max-h-[90vh]","overflow-y-auto"],[1,"text-xl","font-semibold","mb-6","flex","items-center","gap-2"],[1,"fas",3,"ngClass"],[1,"space-y-5",3,"ngSubmit"],["type","text","name","title_en","placeholder","Title (English)","required","",1,"w-full","px-4","py-2","rounded","bg-[#173b3c]","border","border-gray-600","text-white","placeholder-gray-400",3,"ngModelChange","ngModel"],["name","description_en","placeholder","Description (English)","rows","4",1,"w-full","px-4","py-2","rounded","bg-[#173b3c]","border","border-gray-600","text-white","placeholder-gray-400",3,"ngModelChange","ngModel"],["type","text","name","title_ar","placeholder","Title (Arabic)",1,"w-full","px-4","py-2","rounded","bg-[#173b3c]","border","border-gray-600","text-white","placeholder-gray-400",3,"ngModelChange","ngModel"],["name","description_ar","placeholder","Description (Arabic)","rows","4",1,"w-full","px-4","py-2","rounded","bg-[#173b3c]","border","border-gray-600","text-white","placeholder-gray-400",3,"ngModelChange","ngModel"],[1,"block","text-sm","font-medium","text-gray-300","mb-2"],[1,"fas","fa-images","mr-1"],["type","file","multiple","",1,"w-full","px-4","py-2","rounded","bg-[#173b3c]","border","border-gray-600","text-white",3,"change"],[1,"fas","fa-image","mr-1"],[1,"flex","justify-end","space-x-3","pt-4"],["type","button",1,"px-5","py-2","rounded","bg-gray-600","hover:bg-gray-500","text-white","transition-all",3,"click"],[1,"fas","fa-times","mr-1"],["type","submit",1,"px-5","py-2","rounded","bg-[var(--icon-color)]","hover:bg-[#449397]","text-white","font-medium","transition-all"],[1,"fas","fa-save","mr-1"]],template:function(t,i){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),m(4,"i",4),l(5," About Us Management "),r()(),_(6,ne,2,0,"div",5)(7,re,7,1,"div",6)(8,se,22,1,"div",7),r(),_(9,de,27,6,"div",8),r()),t&2&&(s(6),g("ngIf",i.loading),s(),g("ngIf",i.error),s(),g("ngIf",!i.loading&&!i.error),s(),g("ngIf",i.isModalOpen))},dependencies:[B,j,D,N,Y,Q,L,R,G,X,K,J,$,P,W],encapsulation:2})};export{ee as AdminAboutUS};
